def scan_port(ip, port, timeout=1):
    scanner = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    scanner.settimeout(timeout)
    try:
        scanner.connect((ip, port))
        try:
            service = socket.getservbyport(port)
        except:
            service = "Unknown service"
        
        # Banner grabbing
        try:
            scanner.send(b'HEAD / HTTP/1.1\r\nHost: ' + ip.encode() + b'\r\n\r\n')
            banner = scanner.recv(1024).decode().strip()
        except:
            banner = "No banner"

        return port, True, service, banner
    except (socket.timeout, ConnectionRefusedError):
        return port, False, None, None
    except Exception as e:
        print(f"Error: {e}", file=sys.stderr)
        return port, False, None, None
    finally:
        scanner.close()
